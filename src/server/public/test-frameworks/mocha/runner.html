<html>
  <head>
    <title>Mocha</title>
    <script src="mocha.js"></script>
    <script src="customJSONReporter.js"></script>
    <script>
      // mocha.setup( 'bdd' );
      mocha.setup({
        ui: 'bdd',
        reporter: function(runner) {
          new mocha.reporters.JSON(runner);
        }
      });
      
      function assert(expr, msg) {
        if (!expr) throw new Error(msg || 'failed');
      }
      
      function runTests( resultsContainer ) {
        eval( localStorage[ "src" ] );
        eval( localStorage[ "tests" ] );

        mocha.run();
        // var runner = mocha.run();
        // runner.on( "end", function( test ) {
        //   resultsContainer.innerHTML = document.getElementById( "mocha" ).innerHTML
        // });
      };
    </script>
  </head>
  <body>
    <div id="mocha"></div>
  </body>
</html>